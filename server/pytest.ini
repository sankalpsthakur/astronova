[pytest]
# Pytest configuration for comprehensive testing

# Test discovery patterns
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Test directory
testpaths = tests

# Minimum Python version
minversion = 7.4

# Add current directory to Python path
pythonpath = .

# Output options
console_output_style = progress
addopts =
    -v
    --tb=short
    --strict-markers
    -ra
    # Show local variables in tracebacks
    -l
    # Capture output
    --capture=sys
    # Show durations of slowest tests
    --durations=10
    # Ignore deprecation warnings from dependencies
    -W ignore::DeprecationWarning:flask
    -W ignore::DeprecationWarning:werkzeug

# Coverage options (optional, use with: pytest --cov=. --cov-report=html)
# Requires: pip install pytest-cov

# Markers for organizing tests
markers =
    unit: Unit tests (fast, isolated)
    integration: Integration tests (slower, API calls)
    slow: Slow tests (>1s execution time)
    external: Tests requiring external services (ephemeris, geocoding)
    timezone: Timezone-specific tests
    ephemeris: Tests requiring Swiss Ephemeris
    transition: Dasha transition calculation tests
    horoscope: Horoscope generation tests
    api: API endpoint tests
    service: Service layer tests
    performance: Performance benchmark tests
    regression: Regression tests

# Timeout for tests (prevent hanging)
timeout = 30

# Benchmark configuration
benchmark_min_rounds = 5
benchmark_max_time = 1.0
benchmark_min_time = 0.000005
benchmark_timer = time.perf_counter
benchmark_disable_gc = True
benchmark_warmup = True
benchmark_warmup_iterations = 3

# Log configuration
log_cli = false
log_cli_level = INFO
log_file = tests/test_output.log
log_file_level = DEBUG

# Don't collect tests from these directories
norecursedirs =
    .git
    .tox
    dist
    build
    *.egg
    __pycache__
    .cache
    .pytest_cache
    htmlcov
    venv
    env
    .venv

# Parallel execution
# Run with: pytest -n auto
# (requires pytest-xdist)